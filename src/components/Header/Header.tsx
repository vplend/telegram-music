"use client";

import './style.css'
import Image from "next/image";
import {useEffect, useRef, useState} from "react";
import {Avatar, Button, Caption, Text, IconButton} from '@telegram-apps/telegram-ui'
import {useLaunchParams} from "@telegram-apps/sdk-react";

function Header() {
    const [avatarUrl, setAvatarUrl] = useState<string>('');
    const [userName, setUserName] = useState<string | null>(null);
    const launchParams = useLaunchParams();

    useEffect(() => {
        if (typeof window !== "undefined" && launchParams?.tgWebAppData?.user?.id) {
            setAvatarUrl(String(launchParams.tgWebAppData.user.photo_url));
            setUserName(String(launchParams.tgWebAppData.user.username));
        }
    }, [launchParams]);

    return (
        <header className={'header'}>
            <Avatar
                size={20}
                style={{marginRight: '4px'}}
                src={avatarUrl}
            />
            <Button className={'name-button'} size='s' mode={'bezeled'}>{userName}</Button>
            <IconButton className={'settings'} size={'s'}>
                <svg width="13" height="13" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10.88 24H13.12C14.0359 24 14.7531 23.4257 14.9738 22.5421L15.4152 20.6093L15.7021 20.4988L17.3903 21.5481C18.1628 22.0341 19.0786 21.9015 19.7297 21.2499L21.2745 19.7036C21.9366 19.041 22.0469 18.1353 21.5614 17.3732L20.5131 15.6834L20.6234 15.4183L22.5545 14.9655C23.4262 14.7446 24 14.0267 24 13.11V10.9342C24 10.0175 23.4372 9.29959 22.5545 9.07869L20.6345 8.61482L20.5241 8.32766L21.5724 6.64887C22.0579 5.88679 21.9476 4.98113 21.2855 4.30741L19.7407 2.76116C19.1007 2.10953 18.1848 1.98804 17.4124 2.46295L15.7241 3.50115L15.4152 3.3907L14.9738 1.44685C14.7531 0.563277 14.0359 0 13.12 0H10.88C9.9531 0 9.23586 0.563277 9.02621 1.44685L8.58483 3.3907L8.27586 3.50115L6.58759 2.46295C5.80414 1.98804 4.89931 2.10953 4.25931 2.76116L2.70345 4.30741C2.05241 4.98113 1.93103 5.88679 2.41655 6.64887L3.46483 8.32766L3.35448 8.61482L1.44552 9.07869C0.562759 9.29959 0 10.0175 0 10.9342V13.11C0 14.0267 0.573793 14.7446 1.44552 14.9655L3.37655 15.4183L3.47586 15.6834L2.42759 17.3732C1.94207 18.1353 2.06345 19.041 2.71448 19.7036L4.27034 21.2499C4.91034 21.9015 5.82621 22.0341 6.59862 21.5481L8.2869 20.4988L8.58483 20.6093L9.02621 22.5421C9.23586 23.4257 9.9531 24 10.88 24ZM11.1669 21.9678C10.9793 21.9678 10.88 21.8905 10.8579 21.7248L10.1959 19.0078C9.50069 18.8422 8.82759 18.555 8.2869 18.2126L5.90345 19.6815C5.76 19.7699 5.62759 19.7589 5.49517 19.6263L4.33655 18.4666C4.20414 18.3451 4.20414 18.2126 4.29241 18.069L5.76 15.6834C5.45103 15.1532 5.16414 14.4906 4.99862 13.7948L2.2731 13.1431C2.10759 13.121 2.01931 13.0216 2.01931 12.8339V11.1993C2.01931 11.0005 2.09655 10.9231 2.2731 10.879L4.98759 10.2384C5.1531 9.49839 5.4731 8.81362 5.74897 8.31661L4.28138 5.95306C4.1931 5.79844 4.1931 5.6659 4.31448 5.53336L5.48414 4.38472C5.61655 4.26323 5.73793 4.24114 5.90345 4.34054L8.26483 5.78739C8.76138 5.47814 9.50069 5.16889 10.2069 4.99218L10.8579 2.2752C10.88 2.10953 10.9793 2.02117 11.1669 2.02117H12.8331C13.0207 2.02117 13.109 2.09848 13.1421 2.2752L13.8041 5.00322C14.5214 5.17994 15.1724 5.47814 15.7241 5.78739L18.0855 4.34054C18.251 4.25219 18.3724 4.26323 18.5048 4.39577L19.6745 5.54441C19.8069 5.6659 19.8069 5.79844 19.7076 5.95306L18.251 8.31661C18.5159 8.81362 18.8469 9.49839 19.0124 10.2384L21.7269 10.879C21.9034 10.9231 21.9697 11.0005 21.9697 11.1993V12.8339C21.9697 13.0216 21.8924 13.121 21.7269 13.1431L19.0014 13.7948C18.8359 14.4906 18.5379 15.1643 18.229 15.6834L19.6966 18.058C19.7848 18.2126 19.7848 18.3341 19.6524 18.4556L18.4938 19.6263C18.3614 19.7589 18.229 19.7699 18.0855 19.6815L15.7131 18.2126C15.1614 18.555 14.5324 18.8311 13.8041 19.0078L13.1421 21.7248C13.109 21.8905 13.0207 21.9678 12.8331 21.9678H11.1669ZM12.0055 16.1914C14.3007 16.1914 16.1876 14.3028 16.1876 11.9945C16.1876 9.70824 14.3007 7.8196 12.0055 7.8196C9.69931 7.8196 7.80138 9.70824 7.80138 11.9945C7.80138 14.3028 9.69931 16.1914 12.0055 16.1914ZM12.0055 14.2807C10.7476 14.2807 9.72138 13.2536 9.72138 11.9945C9.72138 10.7575 10.7586 9.73033 12.0055 9.73033C13.2303 9.73033 14.2566 10.7575 14.2566 11.9945C14.2566 13.2425 13.2303 14.2807 12.0055 14.2807Z" fill="currentColor"/>
                </svg>
            </IconButton>

        </header>
    )
}

export default Header;